/* Render Class Name so the clickable text is ALWAYS the Class Name
   If there's a URL in the separate "Class Link" column, use that.
   Otherwise, if the Class Name cell itself contains a URL, use it,
   but strip the URL from the visible text so only the class name shows. */
function renderClassNameCell(nameVal, linkVal){
  const rawName = String(nameVal || '').trim();

  // find URL from Class Link column first, else from within the name text
  const urlFromLinkCol = findFirstUrl(linkVal || '');
  const urlFromName    = findFirstUrl(rawName);
  const url            = urlFromLinkCol || urlFromName;

  if(url){
    const href = toAbsoluteUrl(url);

    // Remove the URL from the label if it was embedded in the name
    let label = rawName;
    if(urlFromName){
      label = label.replace(urlFromName, '').replace(/[–—\-|:]+$/,'').trim();
    }

    // If label ended up empty (e.g., cell was just a URL), fall back to rawName, then "Open link"
    const display = label || rawName || 'Open link';

    // Highlight the class name text if user is searching
    return `<a href="${esc(href)}" target="_blank" rel="noopener">${hi(display, QUERY)}</a>`;
  }

  // No URL → keep the italic styling
  return `<em>${hi(rawName, QUERY)}</em>`;
}
